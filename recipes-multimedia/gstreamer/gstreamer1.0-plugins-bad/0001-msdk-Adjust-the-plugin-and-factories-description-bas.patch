From 7aa5261b2ee07cbc707c73845400aacaad755406 Mon Sep 17 00:00:00 2001
From: "Ung, Teng En" <teng.en.ung@intel.com>
Date: Tue, 24 Aug 2021 09:59:59 +0000
Subject: [PATCH] msdk: Adjust the plugin and factories description based on
 MFX_VERSION.

---
 sys/msdk/gstmsdk.c         | 2 +-
 sys/msdk/gstmsdkav1dec.c   | 4 ++--
 sys/msdk/gstmsdkdec.c      | 2 +-
 sys/msdk/gstmsdkenc.c      | 4 ++--
 sys/msdk/gstmsdkh264dec.c  | 4 ++--
 sys/msdk/gstmsdkh264enc.c  | 4 ++--
 sys/msdk/gstmsdkh265dec.c  | 4 ++--
 sys/msdk/gstmsdkh265enc.c  | 4 ++--
 sys/msdk/gstmsdkmjpegdec.c | 4 ++--
 sys/msdk/gstmsdkmjpegenc.c | 4 ++--
 sys/msdk/gstmsdkmpeg2dec.c | 4 ++--
 sys/msdk/gstmsdkmpeg2enc.c | 4 ++--
 sys/msdk/gstmsdkvc1dec.c   | 4 ++--
 sys/msdk/gstmsdkvp8dec.c   | 4 ++--
 sys/msdk/gstmsdkvp9dec.c   | 4 ++--
 sys/msdk/gstmsdkvp9enc.c   | 4 ++--
 sys/msdk/gstmsdkvpp.c      | 6 +++---
 sys/msdk/msdk.c            | 2 +-
 sys/msdk/msdk.h            | 6 ++++++
 19 files changed, 40 insertions(+), 34 deletions(-)

diff --git a/sys/msdk/gstmsdk.c b/sys/msdk/gstmsdk.c
index bbe5799..0773cf5 100644
--- a/sys/msdk/gstmsdk.c
+++ b/sys/msdk/gstmsdk.c
@@ -193,5 +193,5 @@ plugin_init (GstPlugin * plugin)
 GST_PLUGIN_DEFINE (GST_VERSION_MAJOR,
     GST_VERSION_MINOR,
     msdk,
-    "Intel Media SDK based elements",
+    "MFX API (" MFX_API_SDK ") based elements",
     plugin_init, VERSION, "LGPL", GST_PACKAGE_NAME, GST_PACKAGE_ORIGIN)
diff --git a/sys/msdk/gstmsdkav1dec.c b/sys/msdk/gstmsdkav1dec.c
index dfed4d9..5e3ab9e 100644
--- a/sys/msdk/gstmsdkav1dec.c
+++ b/sys/msdk/gstmsdkav1dec.c
@@ -34,7 +34,7 @@
  * @title: msdkav1dec
  * @short_description: Intel MSDK AV1 decoder
  *
- * AV1 video decoder based on Intel Media SDK
+ * AV1 video decoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -118,7 +118,7 @@ gst_msdkav1dec_class_init (GstMsdkAV1DecClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK AV1 decoder",
       "Codec/Decoder/Video/Hardware",
-      "AV1 video decoder based on Intel Media SDK",
+      "AV1 video decoder based on " MFX_API_SDK,
       "Haihao Xiang <haihao.xiang@intel.com>");
 
   gst_element_class_add_static_pad_template (element_class, &sink_factory);
diff --git a/sys/msdk/gstmsdkdec.c b/sys/msdk/gstmsdkdec.c
index 3c565ff..b31258e 100644
--- a/sys/msdk/gstmsdkdec.c
+++ b/sys/msdk/gstmsdkdec.c
@@ -384,7 +384,7 @@ gst_msdkdec_init_decoder (GstMsdkDec * thiz)
       FrameInfo.ChromaFormat : MFX_CHROMAFORMAT_YUV420;
 
   session = gst_msdk_context_get_session (thiz->context);
-  /* validate parameters and allow the Media SDK to make adjustments */
+  /* validate parameters and allow MFX to make adjustments */
   status = MFXVideoDECODE_Query (session, &thiz->param, &thiz->param);
   if (status < MFX_ERR_NONE) {
     GST_ERROR_OBJECT (thiz, "Video Decode Query failed (%s)",
diff --git a/sys/msdk/gstmsdkenc.c b/sys/msdk/gstmsdkenc.c
index 24e2229..db48f49 100644
--- a/sys/msdk/gstmsdkenc.c
+++ b/sys/msdk/gstmsdkenc.c
@@ -575,7 +575,7 @@ gst_msdkenc_init_encoder (GstMsdkEnc * thiz)
         break;
     }
 
-    /* validate parameters and allow the Media SDK to make adjustments */
+    /* validate parameters and allow MFX to make adjustments */
     status = MFXVideoVPP_Query (session, &thiz->vpp_param, &thiz->vpp_param);
     if (status < MFX_ERR_NONE) {
       GST_ERROR_OBJECT (thiz, "Video VPP Query failed (%s)",
@@ -738,7 +738,7 @@ gst_msdkenc_init_encoder (GstMsdkEnc * thiz)
     thiz->param.ExtParam = thiz->extra_params;
   }
 
-  /* validate parameters and allow the Media SDK to make adjustments */
+  /* validate parameters and allow MFX to make adjustments */
   status = MFXVideoENCODE_Query (session, &thiz->param, &thiz->param);
   if (status < MFX_ERR_NONE) {
     GST_ERROR_OBJECT (thiz, "Video Encode Query failed (%s)",
diff --git a/sys/msdk/gstmsdkh264dec.c b/sys/msdk/gstmsdkh264dec.c
index bb4a5fa..4710e1a 100644
--- a/sys/msdk/gstmsdkh264dec.c
+++ b/sys/msdk/gstmsdkh264dec.c
@@ -34,7 +34,7 @@
  * @title: msdkh264dec
  * @short_description: Intel MSDK H264 decoder
  *
- * H264 video decoder based on Intel Media SDK
+ * H264 video decoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -171,7 +171,7 @@ gst_msdkh264dec_class_init (GstMsdkH264DecClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK H264 decoder",
       "Codec/Decoder/Video/Hardware",
-      "H264 video decoder based on Intel Media SDK",
+      "H264 video decoder based on " MFX_API_SDK,
       "Scott D Phillips <scott.d.phillips@intel.com>");
 
   gst_msdkdec_prop_install_output_oder_property (gobject_class);
diff --git a/sys/msdk/gstmsdkh264enc.c b/sys/msdk/gstmsdkh264enc.c
index 888017f..1501b8b 100644
--- a/sys/msdk/gstmsdkh264enc.c
+++ b/sys/msdk/gstmsdkh264enc.c
@@ -34,7 +34,7 @@
  * @title: msdkh264enc
  * @short_description: Intel MSDK H264 encoder
  *
- * H264 video encoder based on Intel Media SDK
+ * H264 video encoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -807,7 +807,7 @@ gst_msdkh264enc_class_init (GstMsdkH264EncClass * klass)
 
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK H264 encoder", "Codec/Encoder/Video/Hardware",
-      "H264 video encoder based on Intel Media SDK",
+      "H264 video encoder based on " MFX_API_SDK,
       "Josep Torra <jtorra@oblong.com>");
   gst_element_class_add_static_pad_template (element_class, &src_factory);
 }
diff --git a/sys/msdk/gstmsdkh265dec.c b/sys/msdk/gstmsdkh265dec.c
index 7e2a770..fe41c09 100644
--- a/sys/msdk/gstmsdkh265dec.c
+++ b/sys/msdk/gstmsdkh265dec.c
@@ -34,7 +34,7 @@
   * @title: msdkh265dec
   * @short_description: Intel MSDK H265 decoder
   *
-  * H265 video decoder based on Intel Media SDK
+  * H265 video decoder based on Intel MFX
   *
   * ## Example launch line
   * ```
@@ -193,7 +193,7 @@ gst_msdkh265dec_class_init (GstMsdkH265DecClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK H265 decoder",
       "Codec/Decoder/Video/Hardware",
-      "H265 video decoder based on Intel Media SDK",
+      "H265 video decoder based on " MFX_API_SDK,
       "Scott D Phillips <scott.d.phillips@intel.com>");
 
   gst_msdkdec_prop_install_output_oder_property (gobject_class);
diff --git a/sys/msdk/gstmsdkh265enc.c b/sys/msdk/gstmsdkh265enc.c
index 25e66ed..7fc5968 100644
--- a/sys/msdk/gstmsdkh265enc.c
+++ b/sys/msdk/gstmsdkh265enc.c
@@ -34,7 +34,7 @@
  * @title: msdkh265enc
  * @short_description: Intel MSDK H265 encoder
  *
- * H265 video encoder based on Intel Media SDK
+ * H265 video encoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -843,7 +843,7 @@ gst_msdkh265enc_class_init (GstMsdkH265EncClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK H265 encoder",
       "Codec/Encoder/Video/Hardware",
-      "H265 video encoder based on Intel Media SDK",
+      "H265 video encoder based on " MFX_API_SDK,
       "Josep Torra <jtorra@oblong.com>");
 
   gst_element_class_add_static_pad_template (element_class, &sink_factory);
diff --git a/sys/msdk/gstmsdkmjpegdec.c b/sys/msdk/gstmsdkmjpegdec.c
index 73324da..620c6b6 100644
--- a/sys/msdk/gstmsdkmjpegdec.c
+++ b/sys/msdk/gstmsdkmjpegdec.c
@@ -34,7 +34,7 @@
  * @title: msdkmjpegdec
  * @short_description: Intel MSDK MJPEG decoder
  *
- * MJPEG video decoder based on Intel Media SDK
+ * MJPEG video decoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -125,7 +125,7 @@ gst_msdkmjpegdec_class_init (GstMsdkMJPEGDecClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK MJPEG decoder",
       "Codec/Decoder/Video/Hardware",
-      "MJPEG video decoder based on Intel Media SDK",
+      "MJPEG video decoder based on " MFX_API_SDK,
       "Scott D Phillips <scott.d.phillips@intel.com>");
 
   gst_element_class_add_static_pad_template (element_class, &sink_factory);
diff --git a/sys/msdk/gstmsdkmjpegenc.c b/sys/msdk/gstmsdkmjpegenc.c
index c4d7f6d..0ed7d98 100644
--- a/sys/msdk/gstmsdkmjpegenc.c
+++ b/sys/msdk/gstmsdkmjpegenc.c
@@ -34,7 +34,7 @@
  * @title: msdkmjpegenc
  * @short_description: Intel MSDK MJPEG encoder
  *
- * MJPEG video encoder based on Intel Media SDK
+ * MJPEG video encoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -193,7 +193,7 @@ gst_msdkmjpegenc_class_init (GstMsdkMJPEGEncClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK MJPEG encoder",
       "Codec/Encoder/Video/Hardware",
-      "MJPEG video encoder based on Intel Media SDK",
+      "MJPEG video encoder based on " MFX_API_SDK,
       "Scott D Phillips <scott.d.phillips@intel.com>");
 
   gst_element_class_add_static_pad_template (element_class, &src_factory);
diff --git a/sys/msdk/gstmsdkmpeg2dec.c b/sys/msdk/gstmsdkmpeg2dec.c
index 31ebc01..4d2f926 100644
--- a/sys/msdk/gstmsdkmpeg2dec.c
+++ b/sys/msdk/gstmsdkmpeg2dec.c
@@ -37,7 +37,7 @@
  * @title: msdkmpeg2dec
  * @short_description: Intel MSDK MPEG2 decoder
  *
- * MPEG2 video decoder based on Intel Media SDK
+ * MPEG2 video decoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -145,7 +145,7 @@ gst_msdkmpeg2dec_class_init (GstMsdkMPEG2DecClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK MPEG2 decoder",
       "Codec/Decoder/Video/Hardware",
-      "MPEG2 video decoder based on Intel Media SDK",
+      "MPEG2 video decoder based on " MFX_API_SDK,
       "Sreerenj Balachandran <sreerenj.balachandran@intel.com>");
 
   gst_msdkdec_prop_install_output_oder_property (gobject_class);
diff --git a/sys/msdk/gstmsdkmpeg2enc.c b/sys/msdk/gstmsdkmpeg2enc.c
index 39435f4..1de4284 100644
--- a/sys/msdk/gstmsdkmpeg2enc.c
+++ b/sys/msdk/gstmsdkmpeg2enc.c
@@ -34,7 +34,7 @@
  * @title: msdkmpeg2enc
  * @short_description: Intel MSDK MPEG2 encoder
  *
- * MPEG2 video encoder based on Intel Media SDK
+ * MPEG2 video encoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -210,7 +210,7 @@ gst_msdkmpeg2enc_class_init (GstMsdkMPEG2EncClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK MPEG2 encoder",
       "Codec/Encoder/Video/Hardware",
-      "MPEG2 video encoder based on Intel Media SDK",
+      "MPEG2 video encoder based on " MFX_API_SDK,
       "Josep Torra <jtorra@oblong.com>");
 
   gst_element_class_add_static_pad_template (element_class, &src_factory);
diff --git a/sys/msdk/gstmsdkvc1dec.c b/sys/msdk/gstmsdkvc1dec.c
index 85ab594..cef1fcf 100644
--- a/sys/msdk/gstmsdkvc1dec.c
+++ b/sys/msdk/gstmsdkvc1dec.c
@@ -36,7 +36,7 @@
  * @title: msdkvc1dec
  * @short_description: Intel MSDK VC1 decoder
  *
- * VC1/WMV video decoder based on Intel Media SDK
+ * VC1/WMV video decoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -203,7 +203,7 @@ gst_msdkvc1dec_class_init (GstMsdkVC1DecClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK VC1 decoder",
       "Codec/Decoder/Video/Hardware",
-      "VC1/WMV video decoder based on Intel Media SDK",
+      "VC1/WMV video decoder based on " MFX_API_SDK,
       "Sreerenj Balachandran <sreerenj.balachandran@intel.com>");
 
   gst_msdkdec_prop_install_output_oder_property (gobject_class);
diff --git a/sys/msdk/gstmsdkvp8dec.c b/sys/msdk/gstmsdkvp8dec.c
index 1ae5835..4033d0d 100644
--- a/sys/msdk/gstmsdkvp8dec.c
+++ b/sys/msdk/gstmsdkvp8dec.c
@@ -35,7 +35,7 @@
  * @title: msdkvp8dec
  * @short_description: Intel MSDK VP8 decoder
  *
- * VP8 video decoder based on Intel Media SDK
+ * VP8 video decoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -190,7 +190,7 @@ gst_msdkvp8dec_class_init (GstMsdkVP8DecClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK VP8 decoder",
       "Codec/Decoder/Video/Hardware",
-      "VP8 video decoder based on Intel Media SDK",
+      "VP8 video decoder based on " MFX_API_SDK,
       "Hyunjun Ko <zzoon@igalia.com>");
 
   gst_msdkdec_prop_install_output_oder_property (gobject_class);
diff --git a/sys/msdk/gstmsdkvp9dec.c b/sys/msdk/gstmsdkvp9dec.c
index b8603d8..847d652 100644
--- a/sys/msdk/gstmsdkvp9dec.c
+++ b/sys/msdk/gstmsdkvp9dec.c
@@ -36,7 +36,7 @@
  * @title: msdkvp9dec
  * @short_description: Intel MSDK VP9 decoderr
  *
- * VP9 video decoder based on Intel Media SDK
+ * VP9 video decoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -185,7 +185,7 @@ gst_msdkvp9dec_class_init (GstMsdkVP9DecClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK VP9 decoder",
       "Codec/Decoder/Video/Hardware",
-      "VP9 video decoder based on Intel Media SDK",
+      "VP9 video decoder based on " MFX_API_SDK,
       "Sreerenj Balachandran <sreerenj.balachandran@intel.com>");
 
   gst_msdkdec_prop_install_output_oder_property (gobject_class);
diff --git a/sys/msdk/gstmsdkvp9enc.c b/sys/msdk/gstmsdkvp9enc.c
index e6a1364..a74dd16 100644
--- a/sys/msdk/gstmsdkvp9enc.c
+++ b/sys/msdk/gstmsdkvp9enc.c
@@ -34,7 +34,7 @@
  * @title: msdkvp9enc
  * @short_description: Intel MSDK VP9 encoder
  *
- * VP9 video encoder based on Intel Media SDK
+ * VP9 video encoder based on Intel MFX
  *
  * ## Example launch line
  * ```
@@ -280,7 +280,7 @@ gst_msdkvp9enc_class_init (GstMsdkVP9EncClass * klass)
   gst_element_class_set_static_metadata (element_class,
       "Intel MSDK VP9 encoder",
       "Codec/Encoder/Video/Hardware",
-      "VP9 video encoder based on Intel Media SDK",
+      "VP9 video encoder based on " MFX_API_SDK,
       "Haihao Xiang <haihao.xiang@intel.com>");
 
   gst_element_class_add_static_pad_template (element_class, &sink_factory);
diff --git a/sys/msdk/gstmsdkvpp.c b/sys/msdk/gstmsdkvpp.c
index bd74e9b..0439e49 100644
--- a/sys/msdk/gstmsdkvpp.c
+++ b/sys/msdk/gstmsdkvpp.c
@@ -1228,7 +1228,7 @@ gst_msdkvpp_initialize (GstMsdkVPP * thiz)
     thiz->param.ExtParam = thiz->extra_params;
   }
 
-  /* validate parameters and allow the Media SDK to make adjustments */
+  /* validate parameters and allow MFX to make adjustments */
   status = MFXVideoVPP_Query (session, &thiz->param, &thiz->param);
   if (status < MFX_ERR_NONE) {
     GST_ERROR_OBJECT (thiz, "Video VPP Query failed (%s)",
@@ -1674,10 +1674,10 @@ gst_msdkvpp_class_init (GstMsdkVPPClass * klass)
       &gst_msdkvpp_sink_factory);
 
   gst_element_class_set_static_metadata (element_class,
-      "MSDK Video Postprocessor",
+      "Intel MSDK Video Postprocessor",
       "Filter/Converter/Video;Filter/Converter/Video/Scaler;"
       "Filter/Effect/Video;Filter/Effect/Video/Deinterlace",
-      "A MediaSDK Video Postprocessing Filter",
+      "Video Postprocessing Filter based on " MFX_API_SDK,
       "Sreerenj Balachandrn <sreerenj.balachandran@intel.com>");
 
   trans_class->start = GST_DEBUG_FUNCPTR (gst_msdkvpp_start);
diff --git a/sys/msdk/msdk.c b/sys/msdk/msdk.c
index 6c87b8a..fe1b97f 100644
--- a/sys/msdk/msdk.c
+++ b/sys/msdk/msdk.c
@@ -291,7 +291,7 @@ msdk_init_msdk_session (mfxIMPL impl, mfxVersion * pver,
   mfxSession session = NULL;
   mfxInitParam init_par = { impl, *pver };
 
-  GST_INFO ("Use the Intel Media SDK to create MFX session");
+  GST_INFO ("Use the " MFX_API_SDK  " to create MFX session");
 
 #if (MFX_VERSION >= 1025)
   init_par.GPUCopy = 1;
diff --git a/sys/msdk/msdk.h b/sys/msdk/msdk.h
index 1d25a4c..6db013d 100644
--- a/sys/msdk/msdk.h
+++ b/sys/msdk/msdk.h
@@ -59,6 +59,12 @@ static const char MFX_PLUGINID_VP9E_HW;
 static const char MFX_PLUGINID_VP9D_HW;
 #endif
 
+#if (MFX_VERSION >= 2000)
+#define MFX_API_SDK  "Intel(R) oneVPL"
+#else
+#define MFX_API_SDK  "Intel(R) Media SDK"
+#endif
+
 G_BEGIN_DECLS
 
 #define GST_MSDK_CAPS_MAKE(format) \
-- 
2.7.4

