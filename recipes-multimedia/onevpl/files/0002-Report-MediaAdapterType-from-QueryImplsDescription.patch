From e9751f4039279b77db74681855f7bc67426401e2 Mon Sep 17 00:00:00 2001
From: "Hoe, Sheng Yang" <sheng.yang.hoe@intel.com>
Date: Fri, 13 Oct 2023 10:25:30 +0800
Subject: [PATCH 2/2] Report MediaAdapterType from QueryImplsDescription

Signed-off-by: Hoe, Sheng Yang <sheng.yang.hoe@intel.com>
---
 _studio/mfx_lib/shared/src/libmfxsw.cpp | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/_studio/mfx_lib/shared/src/libmfxsw.cpp b/_studio/mfx_lib/shared/src/libmfxsw.cpp
index 8dfe489f..ad8cdfcb 100644
--- a/_studio/mfx_lib/shared/src/libmfxsw.cpp
+++ b/_studio/mfx_lib/shared/src/libmfxsw.cpp
@@ -769,6 +769,15 @@ mfxHDL* MFX_CDECL MFXQueryImplsDescription(mfxImplCapsDeliveryFormat format, mfx
                 ah.PushBack(impl.PoolPolicies.Policy) = MFX_ALLOCATION_UNLIMITED;
                 ah.PushBack(impl.PoolPolicies.Policy) = MFX_ALLOCATION_LIMITED;
 
+                impl.Dev.Version.Version  = MFX_STRUCT_VERSION(1, 1);
+                impl.Dev.MediaAdapterType = MFX_MEDIA_UNKNOWN;
+
+                if (auto pCore1_19 = QueryCoreInterface<IVideoCore_API_1_19>(&core, MFXICORE_API_1_19_GUID))
+                {
+                    mfxPlatform platform = {};
+                    if (MFX_ERR_NONE == pCore1_19->QueryPlatform(&platform))
+                        impl.Dev.MediaAdapterType = platform.MediaAdapterType;
+                }
 
                 snprintf(impl.Dev.DeviceID, sizeof(impl.Dev.DeviceID), "%x/%d", deviceId, adapterNum);
                 snprintf(impl.ImplName, sizeof(impl.ImplName), "mfx-gen");
-- 
2.34.1

