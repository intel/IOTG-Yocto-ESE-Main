From 49549a380341e4d467cdb223362e6885a36b9549 Mon Sep 17 00:00:00 2001
From: "Mazlan, Hazwan Arif" <hazwan.arif.mazlan@intel.com>
Date: Wed, 29 Jun 2022 15:05:07 +0800
Subject: [PATCH] Revert "iris: Return non-zero stride for clear color plane"

HSDES ID: 15011043486

Signed-off-by: Mazlan, Hazwan Arif <hazwan.arif.mazlan@intel.com>
---
 src/gallium/drivers/iris/iris_resource.c | 13 +------------
 1 file changed, 1 insertion(+), 12 deletions(-)

diff --git a/src/gallium/drivers/iris/iris_resource.c b/src/gallium/drivers/iris/iris_resource.c
index 043c784dfe76..87f85c9dd6f3 100644
--- a/src/gallium/drivers/iris/iris_resource.c
+++ b/src/gallium/drivers/iris/iris_resource.c
@@ -1658,18 +1658,7 @@ iris_resource_get_param(struct pipe_screen *pscreen,
       }
       return true;
    case PIPE_RESOURCE_PARAM_STRIDE:
-      *value = wants_cc ? 64 :
-               wants_aux ? res->aux.surf.row_pitch_B : res->surf.row_pitch_B;
-
-      /* Mesa's implementation of eglCreateImage rejects strides of zero (see
-       * dri2_check_dma_buf_attribs). Ensure we return a non-zero stride as
-       * this value may be queried from GBM and passed into EGL.
-       *
-       * Also, although modifiers which use a clear color plane specify that
-       * the plane's pitch should be ignored, some kernels have been found to
-       * require 64-byte alignment.
-       */
-      assert(*value != 0 && (!wants_cc || *value % 64 == 0));
+      *value = wants_aux ? res->aux.surf.row_pitch_B : res->surf.row_pitch_B;
 
       return true;
    case PIPE_RESOURCE_PARAM_OFFSET:
-- 
2.34.1

